<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include ../templates/header.ejs %>
  </head>
  <body>
    <div id="app">
      <div class="main-wrapper">
        <%- include ../templates/navtop.ejs %> <%- include
        ../templates/navleft.ejs %>
        <div class="main-content">
          <section class="section">
            <div class="section-header">
              <h1>Dashboard</h1>
              <div class="section-header-breadcrumb">
                <div class="breadcrumb-item active">
                  <a href="#">Dashboard</a>
                </div>
                <div class="breadcrumb-item"><a href="#">Layout</a></div>
                <div class="breadcrumb-item">Default Layout</div>
              </div>
            </div>

            <div class="section-body">
              <div class="row">
                <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <div class="card card-statistic-1">
                    <div class="card-icon bg-danger">
                      <i class="far fa-user"></i>
                    </div>
                    <div class="card-wrap">
                      <div class="card-header">
                        <h4>Fist Class</h4>
                      </div>
                      <div class="card-body" id="tfirst"></div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <div class="card card-statistic-1">
                    <div class="card-icon bg-warning">
                      <i class="fas fa-user-check"></i>
                    </div>
                    <div class="card-wrap">
                      <div class="card-header">
                        <h4>Registred</h4>
                      </div>
                      <div class="card-body" id="tregistred"></div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <div class="card card-statistic-1">
                    <div class="card-icon bg-success">
                      <i class="far fa-newspaper"></i>
                    </div>
                    <div class="card-wrap">
                      <div class="card-header">
                        <h4>Toyota How</h4>
                      </div>
                      <div class="card-body" id="thow"></div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-3 col-md-6 col-sm-6 col-12">
                  <div class="card card-statistic-1">
                    <div class="card-icon bg-primary">
                      <i class="fas fa-book-open"></i>
                    </div>
                    <div class="card-wrap">
                      <div class="card-header">
                        <h4>Enews</h4>
                      </div>
                      <div class="card-body" id="tenews"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- GRAFIKK -->
            <div class="row">
            <!-- <div class="col-lg-8 col-md-12 col-12 col-sm-12">
              <div class="card">
                <div class="card-header">
                  <h4>Last Week's Booking</h4>
                </div>
                <div class="card-body">
                  <canvas id="myChart"></canvas>
                  <div class="statistic-details mt-sm-4">
                    <div class="statistic-details-item">
                      <span class="text-muted"><span class="text-primary"><i class="fas fa-caret-up"></i></span> 7%</span>
                      <div class="detail-value">$243</div>
                      <div class="detail-name">Today's Sales</div>
                    </div>
                    <div class="statistic-details-item">
                      <span class="text-muted"><span class="text-danger"><i class="fas fa-caret-down"></i></span> 23%</span>
                      <div class="detail-value">$2,902</div>
                      <div class="detail-name">This Week's Sales</div>
                    </div>
                    <div class="statistic-details-item">
                      <span class="text-muted"><span class="text-primary"><i class="fas fa-caret-up"></i></span>9%</span>
                      <div class="detail-value">$12,821</div>
                      <div class="detail-name">This Month's Sales</div>
                    </div>
                    <div class="statistic-details-item">
                      <span class="text-muted"><span class="text-primary"><i class="fas fa-caret-up"></i></span> 19%</span>
                      <div class="detail-value">$92,142</div>
                      <div class="detail-name">This Year's Sales</div>
                    </div>
                  </div>
                </div>
              </div>
            </div> -->
            <div class="col-lg-8 col-md-12 col-12 col-sm-12">
              <div class="card">
                <div class="card-header">
                  <h4>Registered Car</h4>
                </div>
                <div class="card-body">
                  <div class="mb-4">
                    <div class="text-small float-right font-weight-bold text-muted" id="talphrad"></div>
                    <div class="font-weight-bold mb-1">Alphard</div>
                    <div class="progress" data-height="3">
                      <div class="progress-bar" role="progressbar" id="alphrad" data-width="" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                  </div>

                  <div class="mb-4">
                    <div class="text-small float-right font-weight-bold text-muted" id="tfortuner"></div>
                    <div class="font-weight-bold mb-1">Fortuner</div>
                    <div class="progress" data-height="3">
                      <div class="progress-bar" role="progressbar" id="fortuner" data-width="" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                  </div>

                  <div class="mb-4">
                    <div class="text-small float-right font-weight-bold text-muted" id="tinnova"></div>
                    <div class="font-weight-bold mb-1">INNOVA</div>
                    <div class="progress" data-height="3">
                      <div class="progress-bar" role="progressbar" id="innova" data-width="" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                  </div>

                  <div class="mb-4">
                    <div class="text-small float-right font-weight-bold text-muted" id="tavanza"></div>
                    <div class="font-weight-bold mb-1">Avanza</div>
                    <div class="progress" data-height="3">
                      <div class="progress-bar" role="progressbar" id="avanza" data-width="" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                  </div>

                </div>
              </div>
            </div>
          </div>
          <!-- END GRAFIK -->
          </section>
        </div>
        <%- include ../templates/footer.ejs %>
      </div>
    </div>
    <%- include ../templates/script.ejs %>
    <script src="<%= process.env.URL %>/script-stisla/assets/js/page/modules-chartjs.js"></script>
    <script>
      $(document).ready(function () {
        getDatadashboard();
      });
      function getDatadashboard() {
        let url = '<%= process.env.URL %>/custfirst/dashboard';
        console.log('sasa')
        $.ajax({
          type: 'GET',
          url: url,
          dataType: 'json',
          success: function (res) {
            console.log(res)
            $('#tfirst').html(res.tfirst.toLocaleString());
            $('#tregistred').html(res.tregisterd.toLocaleString());
            $('#tenews').html(res.tenews.toLocaleString());
            $('#thow').html(res.thow.toLocaleString());
            $('#talphrad').html(res.alphard.toLocaleString());
            $('#tfortuner').html(res.fortuner.toLocaleString());
            $('#tinnova').html(res.innova.toLocaleString());
            $('#tavanza').html(res.avanza.toLocaleString());

            console.log((res.alphard/res.tcars)*100);
            $('#alphrad').attr("data-width",((res.alphard/res.tcars)*100).toFixed()+"%");
            $('#fortuner').attr("data-width",((res.fortuner/res.tcars)*100).toFixed()+"%");
            $('#innova').attr("data-width",((res.innova/res.tcars)*100).toFixed()+"%");
            $('#avanza').attr("data-width",((res.avanza/res.tcars)*100).toFixed()+"%");
          }
        });
      }
    </script>
  </body>
</html>
